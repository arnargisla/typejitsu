var app=function(){"use strict";function e(){}function t(e,t){for(var n in t)e[n]=t[n];return e}function n(e){return e()}function r(){return Object.create(null)}function o(e){e.forEach(n)}function i(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function c(e,t){e.appendChild(t)}function a(e,t,n){e.insertBefore(t,n)}function u(e){e.parentNode.removeChild(e)}function l(e,t){for(var n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function h(e){return document.createElement(e)}function p(e){return document.createTextNode(e)}function f(){return document.createComment("")}function g(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function d(e,t){e.data=""+t}function m(e,t,n){e.style.setProperty(t,n)}function v(e,t,n){e.classList[n?"add":"remove"](t)}let b,y;function w(){b={remaining:0,callbacks:[]}}function S(){b.remaining||o(b.callbacks)}function x(e){b.callbacks.push(e)}function k(e){y=e}let T,C=[];const P=[],$=[];function E(e){$.push(e)}function I(e){P.push(e)}function _(){const e=new Set;do{for(;C.length;){const e=C.shift();k(e),R(e.$$)}for(;P.length;)P.shift()();for(;$.length;){const t=$.pop();e.has(t)||(t(),e.add(t))}}while(C.length);T=null}function R(e){e.fragment&&(e.update(e.dirty),o(e.before_render),e.fragment.p(e.dirty,e.ctx),e.dirty=null,e.after_render.forEach(E))}function O(e,n){var r,o=n.token={};function i(e,r,i,s){if(n.token!==o)return;n.resolved=i&&{[i]:s};const c=t(t({},n.ctx),n.resolved),a=e&&(n.current=e)(c);n.block&&(n.blocks?n.blocks.forEach((e,t)=>{t!==r&&e&&(w(),x(()=>{e.d(1),n.blocks[t]=null}),e.o(1),S())}):n.block.d(1),a.c(),a.i&&a.i(1),a.m(n.mount(),n.anchor),_()),n.block=a,n.blocks&&(n.blocks[r]=a)}if((r=e)&&"function"==typeof r.then){if(e.then(e=>{i(n.then,1,n.value,e)},e=>{i(n.catch,2,n.error,e)}),n.current!==n.pending)return i(n.pending,0),!0}else{if(n.current!==n.then)return i(n.then,1,n.value,e),!0;n.resolved={[n.value]:e}}}function W(e,t,r){const{fragment:s,on_mount:c,on_destroy:a,after_render:u}=e.$$;s.m(t,r),E(()=>{const t=c.map(n).filter(i);a?a.push(...t):o(t),e.$$.on_mount=[]}),u.forEach(E)}function j(e,t){e.$$.dirty||(C.push(e),T||(T=Promise.resolve()).then(_),e.$$.dirty={}),e.$$.dirty[t]=!0}function N(t,n,i,s,c){const a=y;k(t);const u=n.props||{},l=t.$$={fragment:null,ctx:null,update:e,not_equal:c,bound:r(),on_mount:[],on_destroy:[],before_render:[],after_render:[],context:new Map(a?a.$$.context:[]),callbacks:r(),dirty:null};let h=!1;var p;l.ctx=i?i(t,u,(e,n)=>{if(l.bound[e]&&l.bound[e](n),l.ctx){const r=c(n,l.ctx[e]);return h&&r&&j(t,e),l.ctx[e]=n,r}}):u,l.update(),h=!0,o(l.before_render),l.fragment=s(l.ctx),n.target&&(n.hydrate?l.fragment.l((p=n.target,Array.from(p.childNodes))):l.fragment.c(),n.intro&&t.$$.fragment.i&&t.$$.fragment.i(),W(t,n.target,n.anchor),_()),k(a)}class M{$destroy(){var t,n;n=!0,(t=this).$$&&(o(t.$$.on_destroy),t.$$.fragment.d(n),t.$$.on_destroy=t.$$.fragment=null,t.$$.ctx={}),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}function H(e){var t,n,r,o,i,s,l,f,g,m,v,b,y,w,S,x,k,T,C,P,$,E,I,_,R,O,W,j,N,M,H,q,A,L,U=e.textToWrite.slice(e.matchingPrefix.length),F=e.writtenText.slice(e.matchingPrefix.length);return{c(){t=h("div"),n=p("WrittenText: "),r=h("span"),o=p('"'),i=p(e.writtenText),s=p('"'),l=p("\n"),f=h("div"),g=p("Matching Prefix: "),m=h("span"),v=p('"'),b=p(e.matchingPrefix),y=p('"'),w=p("\n"),S=h("div"),x=p("Rest: "),k=h("span"),T=p('"'),C=p(U),P=p('"'),$=p("\n"),E=h("div"),I=p("Wrong letters: "),_=h("span"),R=p('"'),O=p(F),W=p('"'),j=p("\n"),N=h("div"),M=p("no errors: "),H=h("span"),q=p('"'),A=p(e.numberOfErrors),L=p('"'),r.className="svelte-m8oud8",m.className="svelte-m8oud8",k.className="svelte-m8oud8",_.className="svelte-m8oud8",H.className="svelte-m8oud8"},m(e,u){a(e,t,u),c(t,n),c(t,r),c(r,o),c(r,i),c(r,s),a(e,l,u),a(e,f,u),c(f,g),c(f,m),c(m,v),c(m,b),c(m,y),a(e,w,u),a(e,S,u),c(S,x),c(S,k),c(k,T),c(k,C),c(k,P),a(e,$,u),a(e,E,u),c(E,I),c(E,_),c(_,R),c(_,O),c(_,W),a(e,j,u),a(e,N,u),c(N,M),c(N,H),c(H,q),c(H,A),c(H,L)},p(e,t){e.writtenText&&d(i,t.writtenText),e.matchingPrefix&&d(b,t.matchingPrefix),(e.textToWrite||e.matchingPrefix)&&U!==(U=t.textToWrite.slice(t.matchingPrefix.length))&&d(C,U),(e.writtenText||e.matchingPrefix)&&F!==(F=t.writtenText.slice(t.matchingPrefix.length))&&d(O,F),e.numberOfErrors&&d(A,t.numberOfErrors)},d(e){e&&(u(t),u(l),u(f),u(w),u(S),u($),u(E),u(j),u(N))}}}function q(t){var n,r,o,i,s,l,g,m,v,b=t.debug&&H(t);return{c(){n=h("div"),r=h("span"),o=p(t.matchingPrefix),i=h("span"),s=p(t.errorPart),l=h("span"),g=p(t.remainingPart),m=p("\n"),b&&b.c(),v=f(),r.className="correct svelte-m8oud8",i.className="incorrect svelte-m8oud8",l.className="svelte-m8oud8"},m(e,t){a(e,n,t),c(n,r),c(r,o),c(n,i),c(i,s),c(n,l),c(l,g),a(e,m,t),b&&b.m(e,t),a(e,v,t)},p(e,t){e.matchingPrefix&&d(o,t.matchingPrefix),e.errorPart&&d(s,t.errorPart),e.remainingPart&&d(g,t.remainingPart),t.debug?b?b.p(e,t):((b=H(t)).c(),b.m(v.parentNode,v)):b&&(b.d(1),b=null)},i:e,o:e,d(e){e&&(u(n),u(m)),b&&b.d(e),e&&u(v)}}}function A(e,t,n){let r,o,i,s,{textToWrite:c="Populate the textToWrite prop to insert your own text to write!",writtenText:a="",debug:u=!1}=t;return e.$set=(e=>{"textToWrite"in e&&n("textToWrite",c=e.textToWrite),"writtenText"in e&&n("writtenText",a=e.writtenText),"debug"in e&&n("debug",u=e.debug)}),e.$$.update=((e={writtenText:1,textToWrite:1,matchingPrefix:1,numberOfErrors:1})=>{(e.writtenText||e.textToWrite)&&(r=function(e,t){for(let n=e.length;n>0;n--){let r=e.slice(0,n);if(r===t.slice(0,n))return r}return""}(a,c),n("matchingPrefix",r)),(e.writtenText||e.matchingPrefix)&&(o=a.length-r.length,n("numberOfErrors",o)),(e.textToWrite||e.matchingPrefix||e.numberOfErrors)&&(i=c.slice(r.length,r.length+o),n("errorPart",i)),(e.textToWrite||e.matchingPrefix||e.numberOfErrors)&&(s=c.slice(r.length+o),n("remainingPart",s))}),{textToWrite:c,writtenText:a,debug:u,matchingPrefix:r,numberOfErrors:o,errorPart:i,remainingPart:s}}class L extends M{constructor(e){super(),N(this,e,A,q,s)}get textToWrite(){return this.$$.ctx.textToWrite}set textToWrite(e){this.$set({textToWrite:e}),_()}get writtenText(){return this.$$.ctx.writtenText}set writtenText(e){this.$set({writtenText:e}),_()}get debug(){return this.$$.ctx.debug}set debug(e){this.$set({debug:e}),_()}}function U(e){var t,n,r,i,s,l,f,d,m,v,b=new L({props:{textToWrite:e.currentProblem,writtenText:e.writtenText}}),y=""===e.remainingText&&D(e),w=B;return{c(){var o,c,a;b.$$.fragment.c(),t=p("\n\t"),n=h("br"),r=p("\n\t"),i=h("input"),l=p("\n\t"),f=h("div"),y&&y.c(),d=p("\n\t\t"),w&&w.c(),i.autofocus=!0,o=i,c="type",null==(a="text")?o.removeAttribute(c):o.setAttribute(c,a),i.placeholder=s=""===e.confirmedText?`${e.currentProblem.slice(0,10)}...`:"",i.className="svelte-12unudd",v=[g(i,"input",e.input_input_handler),g(i,"input",e.handleInput),g(i,"keyup",e.handleKeyUp)]},m(o,s){W(b,o,s),a(o,t,s),a(o,n,s),a(o,r,s),a(o,i,s),i.value=e.pendingText,a(o,l,s),a(o,f,s),y&&y.m(f,null),c(f,d),w&&w.m(f,null),m=!0,i.focus()},p(e,t){var n={};e.currentProblem&&(n.textToWrite=t.currentProblem),e.writtenText&&(n.writtenText=t.writtenText),b.$set(n),e.pendingText&&(i.value=t.pendingText),m&&!e.confirmedText&&!e.currentProblem||s===(s=""===t.confirmedText?`${t.currentProblem.slice(0,10)}...`:"")||(i.placeholder=s),""===t.remainingText?y||((y=D(t)).c(),y.m(f,d)):y&&(y.d(1),y=null),w&&(w.d(1),w=null)},i(e){m||(b.$$.fragment.i(e),m=!0)},o(e){b.$$.fragment.o(e),m=!1},d(e){b.$destroy(e),e&&(u(t),u(n),u(r),u(i),u(l),u(f)),y&&y.d(),w&&w.d(),o(v)}}}function F(t){var n;return{c(){(n=h("strong")).textContent="Congratulations, you finished the problem set!"},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function D(e){var t;return{c(){(t=h("div")).textContent="Complete! Hit Return ‚Üµ for another challenge!",t.className="complete svelte-12unudd"},m(e,n){a(e,t,n)},d(e){e&&u(t)}}}function G(e){var t,n,r,o,i=[F,U],s=[];function c(e){return e.setCompleted?0:1}return t=c(e),n=s[t]=i[t](e),{c(){n.c(),r=f()},m(e,n){s[t].m(e,n),a(e,r,n),o=!0},p(e,o){var a=t;(t=c(o))===a?s[t].p(e,o):(w(),x(()=>{s[a].d(1),s[a]=null}),n.o(1),S(),(n=s[t])||(n=s[t]=i[t](o)).c(),n.i(1),n.m(r.parentNode,r))},i(e){o||(n&&n.i(),o=!0)},o(e){n&&n.o(),o=!1},d(e){s[t].d(e),e&&u(r)}}}let B=!1;function K(e,t,n){let r,o,{problemSet:i={name:"Example set",problems:["Example text to write!"]},onprogress:s=(()=>{})}=t,{setProblemIndex:c=function(e){n("currentProblemIndex",a=e)}}=t,a=0,u=i.problems[a],l=u,h="",p="";return e.$set=(e=>{"problemSet"in e&&n("problemSet",i=e.problemSet),"onprogress"in e&&n("onprogress",s=e.onprogress),"setProblemIndex"in e&&n("setProblemIndex",c=e.setProblemIndex)}),e.$$.update=((e={problemSet:1,currentProblemIndex:1,currentProblem:1,confirmedText:1,pendingText:1,remainingText:1})=>{(e.problemSet||e.currentProblemIndex||e.currentProblem)&&(u=i.problems[a],n("currentProblem",u),n("remainingText",l=u),n("confirmedText",h=""),n("pendingText",p="")),(e.confirmedText||e.pendingText)&&n("writtenText",r=`${h}${p}`),(e.currentProblemIndex||e.problemSet||e.remainingText)&&(o=a===i.problems.length-1&&""===l,n("setCompleted",o))}),{problemSet:i,onprogress:s,setProblemIndex:c,currentProblem:u,remainingText:l,confirmedText:h,pendingText:p,handleInput:function(e){const t=p===l;(" "===e.data||t)&&(t||p===l.substring(0,p.length))&&(l=l.slice(p.length),n("remainingText",l),n("confirmedText",h=`${h}${p}`),n("pendingText",p=""),s(h.length/u.length))},handleKeyUp:function(e){"Enter"===e.code&&""===l&&(console.log(o,a,i.problems.length-1),o||n("currentProblemIndex",a+=1))},writtenText:r,setCompleted:o,input_input_handler:function(){p=this.value,n("pendingText",p)}}}class J extends M{constructor(e){super(),N(this,e,K,G,s)}get problemSet(){return this.$$.ctx.problemSet}set problemSet(e){this.$set({problemSet:e}),_()}get onprogress(){return this.$$.ctx.onprogress}set onprogress(e){this.$set({onprogress:e}),_()}get setProblemIndex(){return this.$$.ctx.setProblemIndex}set setProblemIndex(e){this.$set({setProblemIndex:e}),_()}}function X(e,t,n){const r=Object.create(e);return r.problemSet=t[n],r.i=n,r}function z(e){var t,n,r,o=e.problemSet.name;function i(...t){return e.click_handler(e,...t)}return{c(){t=h("a"),n=p(o),t.href="#"+e.problemSet.name,t.className="svelte-1b1yjc9",r=g(t,"click",i)},m(e,r){a(e,t,r),c(t,n)},p(t,n){e=n},d(e){e&&u(t),r()}}}function Y(e){for(var t,n,r,o,i,s,f,g,d,m,v=e.problemSets,b=[],y=0;y<v.length;y+=1)b[y]=z(X(e,v,y));let w={problemSet:e.currentProblemSet};var S=new J({props:w});return I(()=>e.practicepad_binding(S)),{c(){t=h("div"),(n=h("h2")).textContent="Welcome to TypeDojo",r=p("\n\t"),o=h("div");for(var e=0;e<b.length;e+=1)b[e].c();i=p("\n\t"),(s=h("div")).textContent="Type the text below into the text field.",f=p("\n\t"),g=h("hr"),d=p("\n\t"),S.$$.fragment.c(),t.className="main svelte-1b1yjc9"},m(e,u){a(e,t,u),c(t,n),c(t,r),c(t,o);for(var l=0;l<b.length;l+=1)b[l].m(o,null);c(t,i),c(t,s),c(t,f),c(t,g),c(t,d),W(S,t,null),m=!0},p(e,t){if(e.problemSets){v=t.problemSets;for(var n=0;n<v.length;n+=1){const r=X(t,v,n);b[n]?b[n].p(e,r):(b[n]=z(r),b[n].c(),b[n].m(o,null))}for(;n<b.length;n+=1)b[n].d(1);b.length=v.length}var r={};e.currentProblemSet&&(r.problemSet=t.currentProblemSet),S.$set(r)},i(e){m||(S.$$.fragment.i(e),m=!0)},o(e){S.$$.fragment.o(e),m=!1},d(n){n&&u(t),l(b,n),e.practicepad_binding(null),S.$destroy()}}}function V(e,t,n){const r=[{name:"Text",problems:["What a wonderful world!","What is this, magic?"]},{name:"Code",problems:["function(x) { return x; }",'() => { return "Hello, world!"; }']},{name:"Numbers & Symbols",problems:["1820 3949 0695 8231","%*@! <(}! >?|) *@)# []&* =~-\\ /.${"]}];let o,i=r[0];function s(e,t){o.setProblemIndex(0),i=r[t],n("currentProblemSet",i),e.preventDefault()}return{problemSets:r,currentProblemSet:i,practicePad:o,handleClick:s,click_handler:function({i:e},t){return s(t,e)},practicepad_binding:function(e){n("practicePad",o=e)}}}class Q extends M{constructor(e){super(),N(this,e,V,Y,s)}}function Z(t){var n,r;return{c(){n=h("div"),(r=h("span")).className="completed svelte-wc8jqk",m(r,"width",Math.floor(100*t.progress)+"%"),n.className="svelte-wc8jqk"},m(e,t){a(e,n,t),c(n,r)},p(e,t){e.progress&&m(r,"width",Math.floor(100*t.progress)+"%")},i:e,o:e,d(e){e&&u(n)}}}function ee(e,t,n){let{progress:r=0}=t;return e.$set=(e=>{"progress"in e&&n("progress",r=e.progress)}),{progress:r}}class te extends M{constructor(e){super(),N(this,e,ee,Z,s)}get progress(){return this.$$.ctx.progress}set progress(e){this.$set({progress:e}),_()}}function ne(e){var t,n,r,o,i,s,l=e.user.name?e.user.name:e.user.id,f=re((100*e.user.progress).toFixed(1),5),g=new te({props:{progress:e.user.progress}});return{c(){t=h("div"),n=p(l),r=p(" "),o=p(f),i=p("%\r\n    "),g.$$.fragment.c(),t.className="svelte-11x4rlf",v(t,"me",e.isme)},m(e,u){a(e,t,u),c(t,n),c(t,r),c(t,o),c(t,i),W(g,t,null),s=!0},p(e,r){s&&!e.user||l===(l=r.user.name?r.user.name:r.user.id)||d(n,l),s&&!e.user||f===(f=re((100*r.user.progress).toFixed(1),5))||d(o,f);var i={};e.user&&(i.progress=r.user.progress),g.$set(i),e.isme&&v(t,"me",r.isme)},i(e){s||(g.$$.fragment.i(e),s=!0)},o(e){g.$$.fragment.o(e),s=!1},d(e){e&&u(t),g.$destroy()}}}function re(e,t){return(e.length<t?Array(t-e.length).join(" "):"")+e}function oe(e,t,n){let{user:r={},isme:o=!1}=t;return e.$set=(e=>{"user"in e&&n("user",r=e.user),"isme"in e&&n("isme",o=e.isme)}),{user:r,isme:o}}class ie extends M{constructor(e){super(),N(this,e,oe,ne,s)}get user(){return this.$$.ctx.user}set user(e){this.$set({user:e}),_()}get isme(){return this.$$.ctx.isme}set isme(e){this.$set({isme:e}),_()}}const se=function(t,n=e){let r;const o=[];function i(e){if(s(t,e)){if(t=e,!r)return;o.forEach(e=>e[1]()),o.forEach(e=>e[0](t))}}return{set:i,update:function(e){i(e(t))},subscribe:function(i,s=e){const c=[i,s];return o.push(c),1===o.length&&(r=n()||e),i(t),()=>{const e=o.indexOf(c);-1!==e&&o.splice(e,1),0===o.length&&r()}}}}({});function ce(e,t,n){const r=Object.create(e);return r.userKey=t[n],r}function ae(t){var n,r,o,i=t.error.message;return{c(){n=h("p"),r=p("Error joining racing group "),o=p(i),m(n,"color","red")},m(e,t){a(e,n,t),c(n,r),c(n,o)},p:e,i:e,o:e,d(e){e&&u(n)}}}function ue(e){var t,n,r,o,i;let s={onprogress:e.progressHandler,problemSet:e.currentProblemSet};var c=new J({props:s});return I(()=>e.practicepad_binding(c)),{c(){(t=h("div")).textContent="Type the text below into the text field.",n=p("\n\t\t"),r=h("hr"),o=p("\n\t\t"),c.$$.fragment.c()},m(e,s){a(e,t,s),a(e,n,s),a(e,r,s),a(e,o,s),W(c,e,s),i=!0},p(e,t){var n={};e.progressHandler&&(n.onprogress=t.progressHandler),e.currentProblemSet&&(n.problemSet=t.currentProblemSet),c.$set(n)},i(e){i||(c.$$.fragment.i(e),i=!0)},o(e){c.$$.fragment.o(e),i=!1},d(i){i&&(u(t),u(n),u(r),u(o)),e.practicepad_binding(null),c.$destroy(i)}}}function le(t){var n;return{c(){(n=h("p")).textContent="...connecting to racing group"},m(e,t){a(e,n,t)},p:e,i:e,o:e,d(e){e&&u(n)}}}function he(e){var t,n=new ie({props:{isme:e.userKey===e.myId,user:e.$currentUsers[e.userKey]}});return{c(){n.$$.fragment.c()},m(e,r){W(n,e,r),t=!0},p(e,t){var r={};(e.$currentUsers||e.myId)&&(r.isme=t.userKey===t.myId),e.$currentUsers&&(r.user=t.$currentUsers[t.userKey]),n.$set(r)},i(e){t||(n.$$.fragment.i(e),t=!0)},o(e){n.$$.fragment.o(e),t=!1},d(e){n.$destroy(e)}}}function pe(e){var n,r,o,i,s,f,g,d,m,v;let b={ctx:e,current:null,pending:le,then:ue,catch:ae,value:"joined",error:"error",blocks:Array(3)};O(i=e.joinRaceGroup,b);for(var y=Object.keys(e.$currentUsers),k=[],T=0;T<y.length;T+=1)k[T]=he(ce(e,y,T));function C(e,t,n){k[e]&&(t&&x(()=>{k[e].d(t),k[e]=null}),k[e].o(n))}return{c(){n=h("div"),(r=h("h2")).textContent="üèçÔ∏è Welcome to Racing in TypeDojo",o=p("\n\n\t"),b.block.c(),s=p("\n\n\t"),f=h("hr"),g=p("\n\t"),d=h("div"),m=p("Connected users:\n\t\t");for(var e=0;e<k.length;e+=1)k[e].c();n.className="main svelte-tctpn1"},m(e,t){a(e,n,t),c(n,r),c(n,o),b.block.m(n,b.anchor=null),b.mount=(()=>n),b.anchor=s,c(n,s),c(n,f),c(n,g),c(n,d),c(d,m);for(var i=0;i<k.length;i+=1)k[i].m(d,null);v=!0},p(n,r){if(e=r,b.ctx=e,i!==(i=e.joinRaceGroup)&&O(i,b)||b.block.p(n,t(t({},e),b.resolved)),n.$currentUsers||n.myId){y=Object.keys(e.$currentUsers);for(var o=0;o<y.length;o+=1){const t=ce(e,y,o);k[o]?(k[o].p(n,t),k[o].i(1)):(k[o]=he(t),k[o].c(),k[o].i(1),k[o].m(d,null))}for(w();o<k.length;o+=1)C(o,1,1);S()}},i(e){if(!v){b.block.i();for(var t=0;t<y.length;t+=1)k[t].i();v=!0}},o(e){for(let e=0;e<3;e+=1){const t=b.blocks[e];t&&t.o()}k=k.filter(Boolean);for(let e=0;e<k.length;e+=1)C(e,0);v=!1},d(e){e&&u(n),b.block.d(),b=null,l(k,e)}}}function fe(e,t,n){let r;var o,i;o=se,i=(e=>{n("$currentUsers",r=e)}),e.$$.on_destroy.push(o.subscribe(i));let{racingGroup:s="defaultRaceGroup",signalrConnection:c,myId:a=""}=t;let u,l=[{name:"Text",problems:["What a wonderful world! A world where you can type and type as you wonder: What does it all mean? Let the letters flow through your fingertips, your fingers like little spiders on the keyboard.","What is this, magic? That is the question everyone is asking themselves, is it really magic or is it just a little bit of good luck and some SignalR?"]},{name:"Code",problems:["function(x) { return x; }",'() => { return "Hello, world!"; }']},{name:"Numbers & Symbols",problems:["1820 3949 0695 8231","%*@! <(}! >?|) *@)# []&* =~-\\ /.${"]}][0];const h=c().then(e=>e.invoke("joinGroup",s));return e.$set=(e=>{"racingGroup"in e&&n("racingGroup",s=e.racingGroup),"signalrConnection"in e&&n("signalrConnection",c=e.signalrConnection),"myId"in e&&n("myId",a=e.myId)}),{racingGroup:s,signalrConnection:c,myId:a,currentProblemSet:l,practicePad:u,joinRaceGroup:h,progressHandler:function(e){c().then(t=>t.invoke("Progress",s,e))},$currentUsers:r,practicepad_binding:function(e){n("practicePad",u=e)}}}class ge extends M{constructor(e){super(),N(this,e,fe,pe,s)}get racingGroup(){return this.$$.ctx.racingGroup}set racingGroup(e){this.$set({racingGroup:e}),_()}get signalrConnection(){return this.$$.ctx.signalrConnection}set signalrConnection(e){this.$set({signalrConnection:e}),_()}get myId(){return this.$$.ctx.myId}set myId(e){this.$set({myId:e}),_()}}var de,me,ve=(de=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},function(e,t){function n(){this.constructor=e}de(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),be=function(e){function t(t,n){var r=this,o=this.constructor.prototype;return(r=e.call(this,t)||this).statusCode=n,r.__proto__=o,r}return ve(t,e),t}(Error),ye=function(e){function t(t){void 0===t&&(t="A timeout occurred.");var n=this,r=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=r,n}return ve(t,e),t}(Error),we=function(e){function t(t){void 0===t&&(t="An abort occurred.");var n=this,r=this.constructor.prototype;return(n=e.call(this,t)||this).__proto__=r,n}return ve(t,e),t}(Error),Se=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},xe=function(){return function(e,t,n){this.statusCode=e,this.statusText=t,this.content=n}}(),ke=function(){function e(){}return e.prototype.get=function(e,t){return this.send(Se({},t,{method:"GET",url:e}))},e.prototype.post=function(e,t){return this.send(Se({},t,{method:"POST",url:e}))},e.prototype.delete=function(e,t){return this.send(Se({},t,{method:"DELETE",url:e}))},e.prototype.getCookieString=function(e){return""},e}();!function(e){e[e.Trace=0]="Trace",e[e.Debug=1]="Debug",e[e.Information=2]="Information",e[e.Warning=3]="Warning",e[e.Error=4]="Error",e[e.Critical=5]="Critical",e[e.None=6]="None"}(me||(me={}));var Te,Ce=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Pe=function(e){function t(t){var n=e.call(this)||this;return n.logger=t,n}return Ce(t,e),t.prototype.send=function(e){var t=this;return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new we):e.method?e.url?new Promise(function(n,r){var o=new XMLHttpRequest;o.open(e.method,e.url,!0),o.withCredentials=!0,o.setRequestHeader("X-Requested-With","XMLHttpRequest"),o.setRequestHeader("Content-Type","text/plain;charset=UTF-8");var i=e.headers;i&&Object.keys(i).forEach(function(e){o.setRequestHeader(e,i[e])}),e.responseType&&(o.responseType=e.responseType),e.abortSignal&&(e.abortSignal.onabort=function(){o.abort(),r(new we)}),e.timeout&&(o.timeout=e.timeout),o.onload=function(){e.abortSignal&&(e.abortSignal.onabort=null),o.status>=200&&o.status<300?n(new xe(o.status,o.statusText,o.response||o.responseText)):r(new be(o.statusText,o.status))},o.onerror=function(){t.logger.log(me.Warning,"Error from HTTP request. "+o.status+": "+o.statusText+"."),r(new be(o.statusText,o.status))},o.ontimeout=function(){t.logger.log(me.Warning,"Timeout from HTTP request."),r(new ye)},o.send(e.content||"")}):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t}(ke),$e=function(){var e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();if("undefined"==typeof XMLHttpRequest){var Ee="function"==typeof __webpack_require__?__non_webpack_require__:require;Te=Ee("./NodeHttpClient")}var Ie=function(e){function t(t){var n=e.call(this)||this;if("undefined"!=typeof XMLHttpRequest)n.httpClient=new Pe(t);else{if(void 0===Te)throw new Error("No HttpClient could be created.");n.httpClient=new Te.NodeHttpClient(t)}return n}return $e(t,e),t.prototype.send=function(e){return e.abortSignal&&e.abortSignal.aborted?Promise.reject(new we):e.method?e.url?this.httpClient.send(e):Promise.reject(new Error("No url defined.")):Promise.reject(new Error("No method defined."))},t.prototype.getCookieString=function(e){return this.httpClient.getCookieString(e)},t}(ke),_e=function(){function e(){}return e.write=function(t){return""+t+e.RecordSeparator},e.parse=function(t){if(t[t.length-1]!==e.RecordSeparator)throw new Error("Message is incomplete.");var n=t.split(e.RecordSeparator);return n.pop(),n},e.RecordSeparatorCode=30,e.RecordSeparator=String.fromCharCode(e.RecordSeparatorCode),e}(),Re=function(){function e(){}return e.prototype.log=function(e,t){},e.instance=new e,e}(),Oe=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},We=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},je=function(){function e(){}return e.isRequired=function(e,t){if(null==e)throw new Error("The '"+t+"' argument is required.")},e.isIn=function(e,t,n){if(!(e in t))throw new Error("Unknown "+n+" value: "+e+".")},e}();function Ne(e,t){var n="";return Me(e)?(n="Binary data of length "+e.byteLength,t&&(n+=". Content: '"+function(e){var t=new Uint8Array(e),n="";return t.forEach(function(e){n+="0x"+(e<16?"0":"")+e.toString(16)+" "}),n.substr(0,n.length-1)}(e)+"'")):"string"==typeof e&&(n="String data of length "+e.length,t&&(n+=". Content: '"+e+"'")),n}function Me(e){return e&&"undefined"!=typeof ArrayBuffer&&(e instanceof ArrayBuffer||e.constructor&&"ArrayBuffer"===e.constructor.name)}function He(e,t,n,r,o,i,s){return Oe(this,void 0,void 0,function(){var c,a,u,l,h;return We(this,function(p){switch(p.label){case 0:return o?[4,o()]:[3,2];case 1:(u=p.sent())&&((c={}).Authorization="Bearer "+u,a=c),p.label=2;case 2:return e.log(me.Trace,"("+t+" transport) sending data. "+Ne(i,s)+"."),l=Me(i)?"arraybuffer":"text",[4,n.post(r,{content:i,headers:a,responseType:l})];case 3:return h=p.sent(),e.log(me.Trace,"("+t+" transport) request complete. Response status: "+h.statusCode+"."),[2]}})})}var qe,Ae=function(){function e(e){this.observers=[],this.cancelCallback=e}return e.prototype.next=function(e){for(var t=0,n=this.observers;t<n.length;t++){n[t].next(e)}},e.prototype.error=function(e){for(var t=0,n=this.observers;t<n.length;t++){var r=n[t];r.error&&r.error(e)}},e.prototype.complete=function(){for(var e=0,t=this.observers;e<t.length;e++){var n=t[e];n.complete&&n.complete()}},e.prototype.subscribe=function(e){return this.observers.push(e),new Le(this,e)},e}(),Le=function(){function e(e,t){this.subject=e,this.observer=t}return e.prototype.dispose=function(){var e=this.subject.observers.indexOf(this.observer);e>-1&&this.subject.observers.splice(e,1),0===this.subject.observers.length&&this.subject.cancelCallback().catch(function(e){})},e}(),Ue=function(){function e(e){this.minimumLogLevel=e}return e.prototype.log=function(e,t){if(e>=this.minimumLogLevel)switch(e){case me.Critical:case me.Error:console.error("["+(new Date).toISOString()+"] "+me[e]+": "+t);break;case me.Warning:console.warn("["+(new Date).toISOString()+"] "+me[e]+": "+t);break;case me.Information:console.info("["+(new Date).toISOString()+"] "+me[e]+": "+t);break;default:console.log("["+(new Date).toISOString()+"] "+me[e]+": "+t)}},e}(),Fe=function(){function e(){}return e.prototype.writeHandshakeRequest=function(e){return _e.write(JSON.stringify(e))},e.prototype.parseHandshakeResponse=function(e){var t,n;if(Me(e)||"undefined"!=typeof Buffer&&e instanceof Buffer){var r=new Uint8Array(e);if(-1===(i=r.indexOf(_e.RecordSeparatorCode)))throw new Error("Message is incomplete.");var o=i+1;t=String.fromCharCode.apply(null,r.slice(0,o)),n=r.byteLength>o?r.slice(o).buffer:null}else{var i,s=e;if(-1===(i=s.indexOf(_e.RecordSeparator)))throw new Error("Message is incomplete.");o=i+1;t=s.substring(0,o),n=s.length>o?s.substring(o):null}var c=_e.parse(t),a=JSON.parse(c[0]);if(a.type)throw new Error("Expected a handshake response from the server.");return[n,a]},e}();!function(e){e[e.Invocation=1]="Invocation",e[e.StreamItem=2]="StreamItem",e[e.Completion=3]="Completion",e[e.StreamInvocation=4]="StreamInvocation",e[e.CancelInvocation=5]="CancelInvocation",e[e.Ping=6]="Ping",e[e.Close=7]="Close"}(qe||(qe={}));var De,Ge=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},Be=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},Ke=3e4,Je=15e3;!function(e){e[e.Disconnected=0]="Disconnected",e[e.Connected=1]="Connected"}(De||(De={}));var Xe,ze,Ye=function(){function e(e,t,n){var r=this;je.isRequired(e,"connection"),je.isRequired(t,"logger"),je.isRequired(n,"protocol"),this.serverTimeoutInMilliseconds=Ke,this.keepAliveIntervalInMilliseconds=Je,this.logger=t,this.protocol=n,this.connection=e,this.handshakeProtocol=new Fe,this.connection.onreceive=function(e){return r.processIncomingData(e)},this.connection.onclose=function(e){return r.connectionClosed(e)},this.callbacks={},this.methods={},this.closedCallbacks=[],this.id=0,this.receivedHandshakeResponse=!1,this.connectionState=De.Disconnected,this.cachedPingMessage=this.protocol.writeMessage({type:qe.Ping})}return e.create=function(t,n,r){return new e(t,n,r)},Object.defineProperty(e.prototype,"state",{get:function(){return this.connectionState},enumerable:!0,configurable:!0}),e.prototype.start=function(){return Ge(this,void 0,void 0,function(){var e,t,n=this;return Be(this,function(r){switch(r.label){case 0:return e={protocol:this.protocol.name,version:this.protocol.version},this.logger.log(me.Debug,"Starting HubConnection."),this.receivedHandshakeResponse=!1,t=new Promise(function(e,t){n.handshakeResolver=e,n.handshakeRejecter=t}),[4,this.connection.start(this.protocol.transferFormat)];case 1:return r.sent(),this.logger.log(me.Debug,"Sending handshake request."),[4,this.sendMessage(this.handshakeProtocol.writeHandshakeRequest(e))];case 2:return r.sent(),this.logger.log(me.Information,"Using HubProtocol '"+this.protocol.name+"'."),this.cleanupTimeout(),this.resetTimeoutPeriod(),this.resetKeepAliveInterval(),[4,t];case 3:return r.sent(),this.connectionState=De.Connected,[2]}})})},e.prototype.stop=function(){return this.logger.log(me.Debug,"Stopping HubConnection."),this.cleanupTimeout(),this.cleanupPingTimer(),this.connection.stop()},e.prototype.stream=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createStreamInvocation(e,n),i=new Ae(function(){var e=t.createCancelInvocation(o.invocationId),n=t.protocol.writeMessage(e);return delete t.callbacks[o.invocationId],t.sendMessage(n)});this.callbacks[o.invocationId]=function(e,t){t?i.error(t):e&&(e.type===qe.Completion?e.error?i.error(new Error(e.error)):i.complete():i.next(e.item))};var s=this.protocol.writeMessage(o);return this.sendMessage(s).catch(function(e){i.error(e),delete t.callbacks[o.invocationId]}),i},e.prototype.sendMessage=function(e){return this.resetKeepAliveInterval(),this.connection.send(e)},e.prototype.send=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.createInvocation(e,t,!0),o=this.protocol.writeMessage(r);return this.sendMessage(o)},e.prototype.invoke=function(e){for(var t=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=this.createInvocation(e,n,!1);return new Promise(function(e,n){t.callbacks[o.invocationId]=function(t,r){r?n(r):t&&(t.type===qe.Completion?t.error?n(new Error(t.error)):e(t.result):n(new Error("Unexpected message type: "+t.type)))};var r=t.protocol.writeMessage(o);t.sendMessage(r).catch(function(e){n(e),delete t.callbacks[o.invocationId]})})},e.prototype.on=function(e,t){e&&t&&(e=e.toLowerCase(),this.methods[e]||(this.methods[e]=[]),-1===this.methods[e].indexOf(t)&&this.methods[e].push(t))},e.prototype.off=function(e,t){if(e){e=e.toLowerCase();var n=this.methods[e];if(n)if(t){var r=n.indexOf(t);-1!==r&&(n.splice(r,1),0===n.length&&delete this.methods[e])}else delete this.methods[e]}},e.prototype.onclose=function(e){e&&this.closedCallbacks.push(e)},e.prototype.processIncomingData=function(e){if(this.cleanupTimeout(),this.receivedHandshakeResponse||(e=this.processHandshakeResponse(e),this.receivedHandshakeResponse=!0),e)for(var t=0,n=this.protocol.parseMessages(e,this.logger);t<n.length;t++){var r=n[t];switch(r.type){case qe.Invocation:this.invokeClientMethod(r);break;case qe.StreamItem:case qe.Completion:var o=this.callbacks[r.invocationId];null!=o&&(r.type===qe.Completion&&delete this.callbacks[r.invocationId],o(r));break;case qe.Ping:break;case qe.Close:this.logger.log(me.Information,"Close message received from server."),this.connection.stop(r.error?new Error("Server returned an error on close: "+r.error):void 0);break;default:this.logger.log(me.Warning,"Invalid message type: "+r.type+".")}}this.resetTimeoutPeriod()},e.prototype.processHandshakeResponse=function(e){var t,n,r;try{r=(t=this.handshakeProtocol.parseHandshakeResponse(e))[0],n=t[1]}catch(e){var o="Error parsing handshake response: "+e;this.logger.log(me.Error,o);var i=new Error(o);throw this.connection.stop(i),this.handshakeRejecter(i),i}if(n.error){o="Server returned handshake error: "+n.error;throw this.logger.log(me.Error,o),this.handshakeRejecter(o),this.connection.stop(new Error(o)),new Error(o)}return this.logger.log(me.Debug,"Server handshake complete."),this.handshakeResolver(),r},e.prototype.resetKeepAliveInterval=function(){var e=this;this.cleanupPingTimer(),this.pingServerHandle=setTimeout(function(){return Ge(e,void 0,void 0,function(){return Be(this,function(e){switch(e.label){case 0:if(this.connectionState!==De.Connected)return[3,4];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this.sendMessage(this.cachedPingMessage)];case 2:return e.sent(),[3,4];case 3:return e.sent(),this.cleanupPingTimer(),[3,4];case 4:return[2]}})})},this.keepAliveIntervalInMilliseconds)},e.prototype.resetTimeoutPeriod=function(){var e=this;this.connection.features&&this.connection.features.inherentKeepAlive||(this.timeoutHandle=setTimeout(function(){return e.serverTimeout()},this.serverTimeoutInMilliseconds))},e.prototype.serverTimeout=function(){this.connection.stop(new Error("Server timeout elapsed without receiving a message from the server."))},e.prototype.invokeClientMethod=function(e){var t=this,n=this.methods[e.target.toLowerCase()];if(n){if(n.forEach(function(n){return n.apply(t,e.arguments)}),e.invocationId){var r="Server requested a response, which is not supported in this version of the client.";this.logger.log(me.Error,r),this.connection.stop(new Error(r))}}else this.logger.log(me.Warning,"No client method with the name '"+e.target+"' found.")},e.prototype.connectionClosed=function(e){var t=this,n=this.callbacks;this.callbacks={},this.connectionState=De.Disconnected,this.handshakeRejecter&&this.handshakeRejecter(e),Object.keys(n).forEach(function(t){(0,n[t])(null,e||new Error("Invocation canceled due to connection being closed."))}),this.cleanupTimeout(),this.cleanupPingTimer(),this.closedCallbacks.forEach(function(n){return n.apply(t,[e])})},e.prototype.cleanupPingTimer=function(){this.pingServerHandle&&clearTimeout(this.pingServerHandle)},e.prototype.cleanupTimeout=function(){this.timeoutHandle&&clearTimeout(this.timeoutHandle)},e.prototype.createInvocation=function(e,t,n){if(n)return{arguments:t,target:e,type:qe.Invocation};var r=this.id;return this.id++,{arguments:t,invocationId:r.toString(),target:e,type:qe.Invocation}},e.prototype.createStreamInvocation=function(e,t){var n=this.id;return this.id++,{arguments:t,invocationId:n.toString(),target:e,type:qe.StreamInvocation}},e.prototype.createCancelInvocation=function(e){return{invocationId:e,type:qe.CancelInvocation}},e}();!function(e){e[e.None=0]="None",e[e.WebSockets=1]="WebSockets",e[e.ServerSentEvents=2]="ServerSentEvents",e[e.LongPolling=4]="LongPolling"}(Xe||(Xe={})),function(e){e[e.Text=1]="Text",e[e.Binary=2]="Binary"}(ze||(ze={}));var Ve=function(){function e(){this.isAborted=!1,this.onabort=null}return e.prototype.abort=function(){this.isAborted||(this.isAborted=!0,this.onabort&&this.onabort())},Object.defineProperty(e.prototype,"signal",{get:function(){return this},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aborted",{get:function(){return this.isAborted},enumerable:!0,configurable:!0}),e}(),Qe=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},Ze=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},et=function(){function e(e,t,n,r){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.pollAbort=new Ve,this.logMessageContent=r,this.running=!1,this.onreceive=null,this.onclose=null}return Object.defineProperty(e.prototype,"pollAborted",{get:function(){return this.pollAbort.aborted},enumerable:!0,configurable:!0}),e.prototype.connect=function(e,t){return Qe(this,void 0,void 0,function(){var n,r,o,i;return Ze(this,function(s){switch(s.label){case 0:if(je.isRequired(e,"url"),je.isRequired(t,"transferFormat"),je.isIn(t,ze,"transferFormat"),this.url=e,this.logger.log(me.Trace,"(LongPolling transport) Connecting."),t===ze.Binary&&"undefined"!=typeof XMLHttpRequest&&"string"!=typeof(new XMLHttpRequest).responseType)throw new Error("Binary protocols over XmlHttpRequest not implementing advanced features are not supported.");return n={abortSignal:this.pollAbort.signal,headers:{},timeout:1e5},t===ze.Binary&&(n.responseType="arraybuffer"),[4,this.getAccessToken()];case 1:return r=s.sent(),this.updateHeaderToken(n,r),o=e+"&_="+Date.now(),this.logger.log(me.Trace,"(LongPolling transport) polling: "+o+"."),[4,this.httpClient.get(o,n)];case 2:return 200!==(i=s.sent()).statusCode?(this.logger.log(me.Error,"(LongPolling transport) Unexpected response code: "+i.statusCode+"."),this.closeError=new be(i.statusText||"",i.statusCode),this.running=!1):this.running=!0,this.receiving=this.poll(this.url,n),[2]}})})},e.prototype.getAccessToken=function(){return Qe(this,void 0,void 0,function(){return Ze(this,function(e){switch(e.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:return[2,e.sent()];case 2:return[2,null]}})})},e.prototype.updateHeaderToken=function(e,t){e.headers||(e.headers={}),t?e.headers.Authorization="Bearer "+t:e.headers.Authorization&&delete e.headers.Authorization},e.prototype.poll=function(e,t){return Qe(this,void 0,void 0,function(){var n,r,o,i;return Ze(this,function(s){switch(s.label){case 0:s.trys.push([0,,8,9]),s.label=1;case 1:return this.running?[4,this.getAccessToken()]:[3,7];case 2:n=s.sent(),this.updateHeaderToken(t,n),s.label=3;case 3:return s.trys.push([3,5,,6]),r=e+"&_="+Date.now(),this.logger.log(me.Trace,"(LongPolling transport) polling: "+r+"."),[4,this.httpClient.get(r,t)];case 4:return 204===(o=s.sent()).statusCode?(this.logger.log(me.Information,"(LongPolling transport) Poll terminated by server."),this.running=!1):200!==o.statusCode?(this.logger.log(me.Error,"(LongPolling transport) Unexpected response code: "+o.statusCode+"."),this.closeError=new be(o.statusText||"",o.statusCode),this.running=!1):o.content?(this.logger.log(me.Trace,"(LongPolling transport) data received. "+Ne(o.content,this.logMessageContent)+"."),this.onreceive&&this.onreceive(o.content)):this.logger.log(me.Trace,"(LongPolling transport) Poll timed out, reissuing."),[3,6];case 5:return i=s.sent(),this.running?i instanceof ye?this.logger.log(me.Trace,"(LongPolling transport) Poll timed out, reissuing."):(this.closeError=i,this.running=!1):this.logger.log(me.Trace,"(LongPolling transport) Poll errored after shutdown: "+i.message),[3,6];case 6:return[3,1];case 7:return[3,9];case 8:return this.logger.log(me.Trace,"(LongPolling transport) Polling complete."),this.pollAborted||this.raiseOnClose(),[7];case 9:return[2]}})})},e.prototype.send=function(e){return Qe(this,void 0,void 0,function(){return Ze(this,function(t){return this.running?[2,He(this.logger,"LongPolling",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return Qe(this,void 0,void 0,function(){var e,t;return Ze(this,function(n){switch(n.label){case 0:this.logger.log(me.Trace,"(LongPolling transport) Stopping polling."),this.running=!1,this.pollAbort.abort(),n.label=1;case 1:return n.trys.push([1,,5,6]),[4,this.receiving];case 2:return n.sent(),this.logger.log(me.Trace,"(LongPolling transport) sending DELETE request to "+this.url+"."),e={headers:{}},[4,this.getAccessToken()];case 3:return t=n.sent(),this.updateHeaderToken(e,t),[4,this.httpClient.delete(this.url,e)];case 4:return n.sent(),this.logger.log(me.Trace,"(LongPolling transport) DELETE request sent."),[3,6];case 5:return this.logger.log(me.Trace,"(LongPolling transport) Stop finished."),this.raiseOnClose(),[7];case 6:return[2]}})})},e.prototype.raiseOnClose=function(){if(this.onclose){var e="(LongPolling transport) Firing onclose event.";this.closeError&&(e+=" Error: "+this.closeError),this.logger.log(me.Trace,e),this.onclose(this.closeError)}},e}(),tt=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},nt=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},rt=function(){function e(e,t,n,r,o){this.httpClient=e,this.accessTokenFactory=t,this.logger=n,this.logMessageContent=r,this.eventSourceConstructor=o,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return tt(this,void 0,void 0,function(){var n,r=this;return nt(this,function(o){switch(o.label){case 0:return je.isRequired(e,"url"),je.isRequired(t,"transferFormat"),je.isIn(t,ze,"transferFormat"),this.logger.log(me.Trace,"(SSE transport) Connecting."),this.url=e,this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var i=!1;if(t===ze.Text){var s;if("undefined"!=typeof window)s=new r.eventSourceConstructor(e,{withCredentials:!0});else{var c=r.httpClient.getCookieString(e);s=new r.eventSourceConstructor(e,{withCredentials:!0,headers:{Cookie:c}})}try{s.onmessage=function(e){if(r.onreceive)try{r.logger.log(me.Trace,"(SSE transport) data received. "+Ne(e.data,r.logMessageContent)+"."),r.onreceive(e.data)}catch(e){return void r.close(e)}},s.onerror=function(e){var t=new Error(e.data||"Error occurred");i?r.close(t):o(t)},s.onopen=function(){r.logger.log(me.Information,"SSE connected to "+r.url),r.eventSource=s,i=!0,n()}}catch(e){return void o(e)}}else o(new Error("The Server-Sent Events transport only supports the 'Text' transfer format"))})]}})})},e.prototype.send=function(e){return tt(this,void 0,void 0,function(){return nt(this,function(t){return this.eventSource?[2,He(this.logger,"SSE",this.httpClient,this.url,this.accessTokenFactory,e,this.logMessageContent)]:[2,Promise.reject(new Error("Cannot send until the transport is connected"))]})})},e.prototype.stop=function(){return this.close(),Promise.resolve()},e.prototype.close=function(e){this.eventSource&&(this.eventSource.close(),this.eventSource=void 0,this.onclose&&this.onclose(e))},e}(),ot=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},it=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},st=function(){function e(e,t,n,r,o){this.logger=n,this.accessTokenFactory=t,this.logMessageContent=r,this.webSocketConstructor=o,this.httpClient=e,this.onreceive=null,this.onclose=null}return e.prototype.connect=function(e,t){return ot(this,void 0,void 0,function(){var n,r=this;return it(this,function(o){switch(o.label){case 0:return je.isRequired(e,"url"),je.isRequired(t,"transferFormat"),je.isIn(t,ze,"transferFormat"),this.logger.log(me.Trace,"(WebSockets transport) Connecting."),this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(n=o.sent())&&(e+=(e.indexOf("?")<0?"?":"&")+"access_token="+encodeURIComponent(n)),o.label=2;case 2:return[2,new Promise(function(n,o){var i;e=e.replace(/^http/,"ws");var s=r.httpClient.getCookieString(e);"undefined"==typeof window&&s&&(i=new r.webSocketConstructor(e,void 0,{headers:{Cookie:""+s}})),i||(i=new r.webSocketConstructor(e)),t===ze.Binary&&(i.binaryType="arraybuffer"),i.onopen=function(t){r.logger.log(me.Information,"WebSocket connected to "+e+"."),r.webSocket=i,n()},i.onerror=function(e){var t=null;"undefined"!=typeof ErrorEvent&&e instanceof ErrorEvent&&(t=e.error),o(t)},i.onmessage=function(e){r.logger.log(me.Trace,"(WebSockets transport) data received. "+Ne(e.data,r.logMessageContent)+"."),r.onreceive&&r.onreceive(e.data)},i.onclose=function(e){return r.close(e)}})]}})})},e.prototype.send=function(e){return this.webSocket&&this.webSocket.readyState===this.webSocketConstructor.OPEN?(this.logger.log(me.Trace,"(WebSockets transport) sending data. "+Ne(e,this.logMessageContent)+"."),this.webSocket.send(e),Promise.resolve()):Promise.reject("WebSocket is not in the OPEN state")},e.prototype.stop=function(){return this.webSocket&&(this.webSocket.onclose=function(){},this.webSocket.onmessage=function(){},this.webSocket.onerror=function(){},this.webSocket.close(),this.webSocket=void 0,this.close(void 0)),Promise.resolve()},e.prototype.close=function(e){this.logger.log(me.Trace,"(WebSockets transport) socket closed."),this.onclose&&(!e||!1!==e.wasClean&&1e3===e.code?this.onclose():this.onclose(new Error("WebSocket closed with status code: "+e.code+" ("+e.reason+").")))},e}(),ct=function(e,t,n,r){return new(n||(n=Promise))(function(o,i){function s(e){try{a(r.next(e))}catch(e){i(e)}}function c(e){try{a(r.throw(e))}catch(e){i(e)}}function a(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(s,c)}a((r=r.apply(e,t||[])).next())})},at=function(e,t){var n,r,o,i,s={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return s.label++,{value:i[1],done:!1};case 5:s.label++,r=i[1],i=[0];continue;case 7:i=s.ops.pop(),s.trys.pop();continue;default:if(!(o=(o=s.trys).length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){s=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){s.label=i[1];break}if(6===i[0]&&s.label<o[1]){s.label=o[1],o=i;break}if(o&&s.label<o[2]){s.label=o[2],s.ops.push(i);break}o[2]&&s.ops.pop(),s.trys.pop();continue}i=t.call(e,s)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}},ut=null,lt=null;if("undefined"==typeof window&&"undefined"!=typeof require){var ht="function"==typeof __webpack_require__?__non_webpack_require__:require;ut=ht("ws"),lt=ht("eventsource")}var pt=function(){function e(e,t){var n;void 0===t&&(t={}),this.features={},je.isRequired(e,"url"),this.logger=void 0===(n=t.logger)?new Ue(me.Information):null===n?Re.instance:n.log?n:new Ue(n),this.baseUrl=this.resolveUrl(e),(t=t||{}).logMessageContent=t.logMessageContent||!1;var r="undefined"==typeof window;r||"undefined"==typeof WebSocket||t.WebSocket?r&&!t.WebSocket&&ut&&(t.WebSocket=ut):t.WebSocket=WebSocket,r||"undefined"==typeof EventSource||t.EventSource?r&&!t.EventSource&&void 0!==lt&&(t.EventSource=lt):t.EventSource=EventSource,this.httpClient=t.httpClient||new Ie(this.logger),this.connectionState=2,this.options=t,this.onreceive=null,this.onclose=null}return e.prototype.start=function(e){return e=e||ze.Binary,je.isIn(e,ze,"transferFormat"),this.logger.log(me.Debug,"Starting connection with transfer format '"+ze[e]+"'."),2!==this.connectionState?Promise.reject(new Error("Cannot start a connection that is not in the 'Disconnected' state.")):(this.connectionState=0,this.startPromise=this.startInternal(e),this.startPromise)},e.prototype.send=function(e){if(1!==this.connectionState)throw new Error("Cannot send data if the connection is not in the 'Connected' State.");return this.transport.send(e)},e.prototype.stop=function(e){return ct(this,void 0,void 0,function(){return at(this,function(t){switch(t.label){case 0:this.connectionState=2,this.stopError=e,t.label=1;case 1:return t.trys.push([1,3,,4]),[4,this.startPromise];case 2:return t.sent(),[3,4];case 3:return t.sent(),[3,4];case 4:return this.transport?[4,this.transport.stop()]:[3,6];case 5:t.sent(),this.transport=void 0,t.label=6;case 6:return[2]}})})},e.prototype.startInternal=function(e){return ct(this,void 0,void 0,function(){var t,n,r,o,i,s,c,a=this;return at(this,function(u){switch(u.label){case 0:t=this.baseUrl,this.accessTokenFactory=this.options.accessTokenFactory,u.label=1;case 1:return u.trys.push([1,12,,13]),this.options.skipNegotiation?this.options.transport!==Xe.WebSockets?[3,3]:(this.transport=this.constructTransport(Xe.WebSockets),[4,this.transport.connect(t,e)]):[3,5];case 2:return u.sent(),[3,4];case 3:throw Error("Negotiation can only be skipped when using the WebSocket transport directly.");case 4:return[3,11];case 5:n=null,r=0,o=function(){var e;return at(this,function(o){switch(o.label){case 0:return[4,i.getNegotiationResponse(t)];case 1:if(n=o.sent(),2===i.connectionState)return[2,{value:void 0}];if(n.error)throw Error(n.error);if(n.ProtocolVersion)throw Error("Detected a connection attempt to an ASP.NET SignalR Server. This client only supports connecting to an ASP.NET Core SignalR Server. See https://aka.ms/signalr-core-differences for details.");return n.url&&(t=n.url),n.accessToken&&(e=n.accessToken,i.accessTokenFactory=function(){return e}),r++,[2]}})},i=this,u.label=6;case 6:return[5,o()];case 7:if("object"==typeof(s=u.sent()))return[2,s.value];u.label=8;case 8:if(n.url&&r<100)return[3,6];u.label=9;case 9:if(100===r&&n.url)throw Error("Negotiate redirection limit exceeded.");return[4,this.createTransport(t,this.options.transport,n,e)];case 10:u.sent(),u.label=11;case 11:return this.transport instanceof et&&(this.features.inherentKeepAlive=!0),this.transport.onreceive=this.onreceive,this.transport.onclose=function(e){return a.stopConnection(e)},this.changeState(0,1),[3,13];case 12:throw c=u.sent(),this.logger.log(me.Error,"Failed to start the connection: "+c),this.connectionState=2,this.transport=void 0,c;case 13:return[2]}})})},e.prototype.getNegotiationResponse=function(e){return ct(this,void 0,void 0,function(){var t,n,r,o,i,s;return at(this,function(c){switch(c.label){case 0:return this.accessTokenFactory?[4,this.accessTokenFactory()]:[3,2];case 1:(r=c.sent())&&((t={}).Authorization="Bearer "+r,n=t),c.label=2;case 2:o=this.resolveNegotiateUrl(e),this.logger.log(me.Debug,"Sending negotiation request: "+o+"."),c.label=3;case 3:return c.trys.push([3,5,,6]),[4,this.httpClient.post(o,{content:"",headers:n})];case 4:if(200!==(i=c.sent()).statusCode)throw Error("Unexpected status code returned from negotiate "+i.statusCode);return[2,JSON.parse(i.content)];case 5:throw s=c.sent(),this.logger.log(me.Error,"Failed to complete negotiation with the server: "+s),s;case 6:return[2]}})})},e.prototype.createConnectUrl=function(e,t){return t?e+(-1===e.indexOf("?")?"?":"&")+"id="+t:e},e.prototype.createTransport=function(e,t,n,r){return ct(this,void 0,void 0,function(){var o,i,s,c,a,u,l;return at(this,function(h){switch(h.label){case 0:return o=this.createConnectUrl(e,n.connectionId),this.isITransport(t)?(this.logger.log(me.Debug,"Connection was provided an instance of ITransport, using that directly."),this.transport=t,[4,this.transport.connect(o,r)]):[3,2];case 1:return h.sent(),this.changeState(0,1),[2];case 2:i=n.availableTransports||[],s=0,c=i,h.label=3;case 3:return s<c.length?(a=c[s],this.connectionState=0,"number"!=typeof(u=this.resolveTransport(a,t,r))?[3,8]:(this.transport=this.constructTransport(u),n.connectionId?[3,5]:[4,this.getNegotiationResponse(e)])):[3,9];case 4:n=h.sent(),o=this.createConnectUrl(e,n.connectionId),h.label=5;case 5:return h.trys.push([5,7,,8]),[4,this.transport.connect(o,r)];case 6:return h.sent(),this.changeState(0,1),[2];case 7:return l=h.sent(),this.logger.log(me.Error,"Failed to start the transport '"+Xe[u]+"': "+l),this.connectionState=2,n.connectionId=void 0,[3,8];case 8:return s++,[3,3];case 9:throw new Error("Unable to initialize any of the available transports.")}})})},e.prototype.constructTransport=function(e){switch(e){case Xe.WebSockets:if(!this.options.WebSocket)throw new Error("'WebSocket' is not supported in your environment.");return new st(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.WebSocket);case Xe.ServerSentEvents:if(!this.options.EventSource)throw new Error("'EventSource' is not supported in your environment.");return new rt(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1,this.options.EventSource);case Xe.LongPolling:return new et(this.httpClient,this.accessTokenFactory,this.logger,this.options.logMessageContent||!1);default:throw new Error("Unknown transport: "+e+".")}},e.prototype.resolveTransport=function(e,t,n){var r=Xe[e.transport];if(null==r)this.logger.log(me.Debug,"Skipping transport '"+e.transport+"' because it is not supported by this client.");else{var o=e.transferFormats.map(function(e){return ze[e]});if(function(e,t){return!e||0!=(t&e)}(t,r))if(o.indexOf(n)>=0){if((r!==Xe.WebSockets||this.options.WebSocket)&&(r!==Xe.ServerSentEvents||this.options.EventSource))return this.logger.log(me.Debug,"Selecting transport '"+Xe[r]+"'."),r;this.logger.log(me.Debug,"Skipping transport '"+Xe[r]+"' because it is not supported in your environment.'")}else this.logger.log(me.Debug,"Skipping transport '"+Xe[r]+"' because it does not support the requested transfer format '"+ze[n]+"'.");else this.logger.log(me.Debug,"Skipping transport '"+Xe[r]+"' because it was disabled by the client.")}return null},e.prototype.isITransport=function(e){return e&&"object"==typeof e&&"connect"in e},e.prototype.changeState=function(e,t){return this.connectionState===e&&(this.connectionState=t,!0)},e.prototype.stopConnection=function(e){this.transport=void 0,(e=this.stopError||e)?this.logger.log(me.Error,"Connection disconnected with error '"+e+"'."):this.logger.log(me.Information,"Connection disconnected."),this.connectionState=2,this.onclose&&this.onclose(e)},e.prototype.resolveUrl=function(e){if(0===e.lastIndexOf("https://",0)||0===e.lastIndexOf("http://",0))return e;if("undefined"==typeof window||!window||!window.document)throw new Error("Cannot resolve '"+e+"'.");var t=window.document.createElement("a");return t.href=e,this.logger.log(me.Information,"Normalizing '"+e+"' to '"+t.href+"'."),t.href},e.prototype.resolveNegotiateUrl=function(e){var t=e.indexOf("?"),n=e.substring(0,-1===t?e.length:t);return"/"!==n[n.length-1]&&(n+="/"),n+="negotiate",n+=-1===t?"":e.substring(t)},e}();var ft="json",gt=function(){function e(){this.name=ft,this.version=1,this.transferFormat=ze.Text}return e.prototype.parseMessages=function(e,t){if("string"!=typeof e)throw new Error("Invalid input for JSON hub protocol. Expected a string.");if(!e)return[];null===t&&(t=Re.instance);for(var n=[],r=0,o=_e.parse(e);r<o.length;r++){var i=o[r],s=JSON.parse(i);if("number"!=typeof s.type)throw new Error("Invalid payload.");switch(s.type){case qe.Invocation:this.isInvocationMessage(s);break;case qe.StreamItem:this.isStreamItemMessage(s);break;case qe.Completion:this.isCompletionMessage(s);break;case qe.Ping:case qe.Close:break;default:t.log(me.Information,"Unknown message type '"+s.type+"' ignored.");continue}n.push(s)}return n},e.prototype.writeMessage=function(e){return _e.write(JSON.stringify(e))},e.prototype.isInvocationMessage=function(e){this.assertNotEmptyString(e.target,"Invalid payload for Invocation message."),void 0!==e.invocationId&&this.assertNotEmptyString(e.invocationId,"Invalid payload for Invocation message.")},e.prototype.isStreamItemMessage=function(e){if(this.assertNotEmptyString(e.invocationId,"Invalid payload for StreamItem message."),void 0===e.item)throw new Error("Invalid payload for StreamItem message.")},e.prototype.isCompletionMessage=function(e){if(e.result&&e.error)throw new Error("Invalid payload for Completion message.");!e.result&&e.error&&this.assertNotEmptyString(e.error,"Invalid payload for Completion message."),this.assertNotEmptyString(e.invocationId,"Invalid payload for Completion message.")},e.prototype.assertNotEmptyString=function(e,t){if("string"!=typeof e||""===e)throw new Error(t)},e}();const dt=(new(function(){function e(){}return e.prototype.configureLogging=function(e){return je.isRequired(e,"logging"),void 0!==e.log?this.logger=e:this.logger=new Ue(e),this},e.prototype.withUrl=function(e,t){return je.isRequired(e,"url"),this.url=e,this.httpConnectionOptions="object"==typeof t?t:{transport:t},this},e.prototype.withHubProtocol=function(e){return je.isRequired(e,"protocol"),this.protocol=e,this},e.prototype.build=function(){var e=this.httpConnectionOptions||{};if(void 0===e.logger&&(e.logger=this.logger),!this.url)throw new Error("The 'HubConnectionBuilder.withUrl' method must be called before building the connection.");var t=new pt(this.url,e);return Ye.create(t,this.logger||Re.instance,this.protocol||new gt)},e}())).withUrl("http://localhost:8888/raceHub").configureLogging(me.Information).build();window.g_connection=dt;var mt={0:"connecting",1:"connected",2:"reconnecting",4:"disconnected"};let vt,bt="",yt="";async function wt(){let e=0;for(;"connected"!==mt[dt.connectionState]&&e<5;)e++,await kt(5);return dt}0===window.location.hash.indexOf("#race")?(yt=function(){let e=sessionStorage?sessionStorage.getItem("name"):"";return e||(e=prompt("What is your name?"),sessionStorage&&sessionStorage.setItem("name",e)),e}(),vt=new ge({target:document.body,props:{signalrConnection:wt,racingGroup:window.location.hash.split("=")[1],myId:"me"}})):vt=new Q({target:document.body});let St=0;async function xt(){try{await dt.start(),console.log("Successfully connected to hub")}catch(e){console.log(e),console.log("Retrying in 5 seconds"),(St+=1)<10&&setTimeout(()=>xt(),5e3)}}async function kt(e){return new Promise((t,n)=>{setTimeout(t,1e3*e)})}return dt.onclose(async()=>{await xt()}),xt(),dt.on("ReceiveMessage",function(e){console.log(`Received message: ${e}`)}),dt.on("YouAre",e=>{bt=e,se.update(t=>(t[e]={id:e,progress:0,name:yt},t)),vt.myId&&vt.$set({myId:bt}),console.log(`YouAre: ${e}`)}),dt.on("UserJoined",e=>{se.update(t=>(t[e]={id:e,progress:0},t)),bt&&wt().then(t=>t.invoke("CallUser",e,"ImHere",bt)),console.log(`User: ${e} joined`)}),dt.on("ImHere",e=>{se.update(t=>(t[e]={id:e,progress:0},t)),console.log(`User: ${e} says hello`)}),dt.on("UserProgress",(e,t)=>{se.update(n=>(n[e]={id:e,progress:t},n)),console.log(`User: ${e} joined`)}),dt.on("UserLeft",e=>{se.update(t=>(t[e]=void 0,t)),console.log(`User: ${e} left`)}),window.g_test2=async function(e){try{await dt.invoke("JoinGroup","test-group")}catch(e){return console.error(e.toString())}},vt}();
//# sourceMappingURL=bundle.js.map
